<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Greek Dict">
    <title>Ancient Greek Dictionary</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --primary: #d4a27c;
            --primary-light: #e8c4a8;
            --accent: #c97c5d;
            --bg: #1a1915;
            --card-bg: #2a2722;
            --text: #e8e4de;
            --text-light: #a8a29e;
            --border: #3d3830;
            --input-bg: #1f1d19;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding-bottom: 80px;
        }

        header {
            background: var(--card-bg);
            color: var(--text);
            padding: 20px 16px 16px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            border-bottom: 1px solid var(--border);
        }

        h1 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .subtitle {
            font-size: 13px;
            opacity: 0.85;
        }

        .search-container {
            margin-top: 14px;
            position: relative;
        }

        #search {
            width: 100%;
            padding: 12px 16px 12px 42px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            background: var(--input-bg);
            color: var(--text);
        }

        #search::placeholder {
            color: var(--text-light);
        }

        #search:focus {
            outline: none;
            border-color: var(--primary);
        }

        .search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            font-size: 16px;
        }

        .tabs {
            display: flex;
            background: var(--card-bg);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 118px;
            z-index: 99;
        }

        .tab {
            flex: 1;
            padding: 14px;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-light);
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tab.active {
            color: var(--primary-light);
            border-bottom-color: var(--primary);
        }

        .content {
            padding: 12px;
        }

        .word-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            border: 1px solid var(--border);
        }

        .word-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .greek-word {
            font-size: 22px;
            font-weight: 600;
            color: var(--primary);
        }

        .romanized {
            font-size: 14px;
            color: var(--text-light);
            font-style: italic;
            margin-top: 2px;
        }

        .meaning {
            font-size: 15px;
            line-height: 1.5;
            color: var(--text);
            margin-top: 8px;
        }

        .category {
            display: inline-block;
            font-size: 11px;
            padding: 4px 10px;
            background: var(--border);
            color: var(--primary-light);
            border-radius: 20px;
            margin-top: 10px;
            font-weight: 500;
        }

        .grammar {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid var(--border);
        }

        .grammar-tag {
            font-size: 10px;
            padding: 3px 8px;
            background: var(--input-bg);
            color: var(--text-light);
            border-radius: 4px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .grammar-tag.gender-m { color: #7cb3d9; }
        .grammar-tag.gender-f { color: #d99bc9; }
        .grammar-tag.gender-n { color: #a8d4a0; }

        .form-row {
            display: flex;
            gap: 12px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .favorite-btn {
            background: none;
            border: none;
            font-size: 22px;
            cursor: pointer;
            padding: 4px;
            color: var(--text-light);
            transition: all 0.2s;
        }

        .favorite-btn.active {
            color: #e07b5d;
        }

        .add-btn {
            position: fixed;
            bottom: 24px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--accent);
            color: var(--bg);
            border: none;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 4px 16px rgba(201,124,93,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 200;
            align-items: flex-end;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--card-bg);
            width: 100%;
            max-width: 500px;
            border-radius: 20px 20px 0 0;
            padding: 24px 20px 40px;
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal h2 {
            font-size: 20px;
            margin-bottom: 20px;
            color: var(--primary-light);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--text-light);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            background: var(--input-bg);
            color: var(--text);
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .btn {
            flex: 1;
            padding: 14px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            border: none;
        }

        .btn-primary {
            background: var(--accent);
            color: var(--bg);
        }

        .btn-secondary {
            background: var(--border);
            color: var(--text);
        }

        .btn:active {
            transform: scale(0.98);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-light);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .delete-btn {
            background: none;
            border: none;
            color: #e07b5d;
            font-size: 14px;
            cursor: pointer;
            padding: 4px 8px;
            margin-left: 8px;
        }

        .word-actions {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .stats {
            display: flex;
            gap: 20px;
            padding: 16px;
            background: var(--card-bg);
            margin: 12px;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .stat {
            text-align: center;
            flex: 1;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 600;
            color: var(--primary-light);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-light);
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Ancient Greek Dictionary</h1>
        <p class="subtitle">Learn the language of philosophers</p>
        <div class="search-container">
            <span class="search-icon">&#128269;</span>
            <input type="text" id="search" placeholder="Search Greek or English...">
        </div>
    </header>

    <div class="tabs">
        <button class="tab active" data-tab="all">All Words</button>
        <button class="tab" data-tab="favorites">Favorites</button>
        <button class="tab" data-tab="custom">My Words</button>
    </div>

    <div class="stats">
        <div class="stat">
            <div class="stat-value" id="total-count">0</div>
            <div class="stat-label">Total Words</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="favorites-count">0</div>
            <div class="stat-label">Favorites</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="custom-count">0</div>
            <div class="stat-label">My Words</div>
        </div>
    </div>

    <div class="content" id="word-list"></div>

    <button class="add-btn" id="add-btn">+</button>

    <div class="modal-overlay" id="modal">
        <div class="modal">
            <h2>Add New Word</h2>
            <div class="form-group">
                <label>Greek Word (in Greek alphabet)</label>
                <input type="text" id="input-greek" placeholder="e.g., σοφία">
            </div>
            <div class="form-group">
                <label>Romanized (optional)</label>
                <input type="text" id="input-romanized" placeholder="e.g., sophia">
            </div>
            <div class="form-group">
                <label>Meaning</label>
                <textarea id="input-meaning" placeholder="e.g., wisdom, knowledge"></textarea>
            </div>
            <div class="form-group">
                <label>Category</label>
                <select id="input-category">
                    <option value="noun">Noun</option>
                    <option value="verb">Verb</option>
                    <option value="adjective">Adjective</option>
                    <option value="adverb">Adverb</option>
                    <option value="preposition">Preposition</option>
                    <option value="phrase">Phrase</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Declension</label>
                    <select id="input-declension">
                        <option value="">-</option>
                        <option value="1st">1st</option>
                        <option value="2nd">2nd</option>
                        <option value="3rd">3rd</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Gender</label>
                    <select id="input-gender">
                        <option value="">-</option>
                        <option value="m">Masculine</option>
                        <option value="f">Feminine</option>
                        <option value="n">Neuter</option>
                        <option value="m/f">Masc/Fem</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Number</label>
                    <select id="input-number">
                        <option value="">-</option>
                        <option value="sg">Singular</option>
                        <option value="pl">Plural</option>
                    </select>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="cancel-btn">Cancel</button>
                <button class="btn btn-primary" id="save-btn">Save Word</button>
            </div>
        </div>
    </div>

    <script>
        // Default dictionary of basic Ancient Greek words
        const defaultWords = [
            { id: 1, greek: "λόγος", romanized: "logos", meaning: "Word, reason, speech, logic. One of the most important Greek philosophical terms, referring to rational discourse or the divine principle ordering the universe.", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 2, greek: "σοφία", romanized: "sophia", meaning: "Wisdom. The root of 'philosophy' (love of wisdom).", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 3, greek: "ἀρετή", romanized: "arete", meaning: "Excellence, virtue, moral goodness. The highest effectiveness and living up to one's full potential.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 4, greek: "πόλις", romanized: "polis", meaning: "City-state. The fundamental political unit of ancient Greece.", category: "noun", declension: "3rd", gender: "f", number: "sg", custom: false },
            { id: 5, greek: "ἀγάπη", romanized: "agape", meaning: "Unconditional love, divine love, selfless love for others.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 6, greek: "ἔρως", romanized: "eros", meaning: "Romantic love, desire, passionate love.", category: "noun", declension: "3rd", gender: "m", number: "sg", custom: false },
            { id: 7, greek: "φιλία", romanized: "philia", meaning: "Friendship, brotherly love, affection between friends.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 8, greek: "στοργή", romanized: "storge", meaning: "Family love, natural affection, especially between parents and children.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 9, greek: "ψυχή", romanized: "psyche", meaning: "Soul, mind, spirit, breath of life.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 10, greek: "νοῦς", romanized: "nous", meaning: "Mind, intellect, reason, understanding.", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 11, greek: "ἀλήθεια", romanized: "aletheia", meaning: "Truth, disclosure, unconcealment.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 12, greek: "καλός", romanized: "kalos", meaning: "Beautiful, noble, good. Often paired with 'agathos' (good).", category: "adjective", declension: "1st/2nd", gender: "m/f/n", number: "sg", custom: false },
            { id: 13, greek: "ἀγαθός", romanized: "agathos", meaning: "Good, noble, brave, capable.", category: "adjective", declension: "1st/2nd", gender: "m/f/n", number: "sg", custom: false },
            { id: 14, greek: "θεός", romanized: "theos", meaning: "God, deity, divine being.", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 15, greek: "κόσμος", romanized: "kosmos", meaning: "Order, world, universe. Also means ornament or decoration.", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 16, greek: "χάος", romanized: "chaos", meaning: "Void, chasm, the primordial state before creation.", category: "noun", declension: "2nd", gender: "n", number: "sg", custom: false },
            { id: 17, greek: "ἄνθρωπος", romanized: "anthropos", meaning: "Human being, person, mankind.", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 18, greek: "δῆμος", romanized: "demos", meaning: "The people, the common people, the populace.", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 19, greek: "κράτος", romanized: "kratos", meaning: "Power, strength, rule, authority.", category: "noun", declension: "3rd", gender: "n", number: "sg", custom: false },
            { id: 20, greek: "δημοκρατία", romanized: "demokratia", meaning: "Democracy - rule by the people (demos + kratos).", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 21, greek: "τέχνη", romanized: "techne", meaning: "Art, skill, craft, technique. The root of 'technology'.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 22, greek: "ἐπιστήμη", romanized: "episteme", meaning: "Knowledge, science, systematic understanding.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 23, greek: "δόξα", romanized: "doxa", meaning: "Opinion, belief, glory, reputation.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 24, greek: "εὐδαιμονία", romanized: "eudaimonia", meaning: "Happiness, flourishing, well-being. The ultimate goal of life in Greek ethics.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 25, greek: "ἦθος", romanized: "ethos", meaning: "Character, custom, habit. The root of 'ethics'.", category: "noun", declension: "3rd", gender: "n", number: "sg", custom: false },
            { id: 26, greek: "πάθος", romanized: "pathos", meaning: "Suffering, experience, emotion, passion.", category: "noun", declension: "3rd", gender: "n", number: "sg", custom: false },
            { id: 27, greek: "ὕβρις", romanized: "hubris", meaning: "Excessive pride, arrogance against the gods.", category: "noun", declension: "3rd", gender: "f", number: "sg", custom: false },
            { id: 28, greek: "νέμεσις", romanized: "nemesis", meaning: "Righteous anger, divine retribution, just punishment.", category: "noun", declension: "3rd", gender: "f", number: "sg", custom: false },
            { id: 29, greek: "καιρός", romanized: "kairos", meaning: "The right moment, opportune time, critical time.", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 30, greek: "χρόνος", romanized: "chronos", meaning: "Time (sequential, quantitative time).", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 31, greek: "ἀρχή", romanized: "arche", meaning: "Beginning, origin, first principle, sovereignty.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 32, greek: "τέλος", romanized: "telos", meaning: "End, goal, purpose, fulfillment.", category: "noun", declension: "3rd", gender: "n", number: "sg", custom: false },
            { id: 33, greek: "πρᾶγμα", romanized: "pragma", meaning: "Thing, matter, affair, deed.", category: "noun", declension: "3rd", gender: "n", number: "sg", custom: false },
            { id: 34, greek: "ἔργον", romanized: "ergon", meaning: "Work, deed, task, function.", category: "noun", declension: "2nd", gender: "n", number: "sg", custom: false },
            { id: 35, greek: "οἶκος", romanized: "oikos", meaning: "House, household, family. Root of 'economy' and 'ecology'.", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 36, greek: "νόμος", romanized: "nomos", meaning: "Law, custom, convention.", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 37, greek: "φύσις", romanized: "physis", meaning: "Nature, natural order, growth.", category: "noun", declension: "3rd", gender: "f", number: "sg", custom: false },
            { id: 38, greek: "δύναμις", romanized: "dynamis", meaning: "Power, ability, potential, capacity.", category: "noun", declension: "3rd", gender: "f", number: "sg", custom: false },
            { id: 39, greek: "ἐνέργεια", romanized: "energeia", meaning: "Activity, actuality, being-at-work. Root of 'energy'.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 40, greek: "μετάνοια", romanized: "metanoia", meaning: "Change of mind, repentance, transformation of heart.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 41, greek: "γνῶσις", romanized: "gnosis", meaning: "Knowledge, especially spiritual or esoteric knowledge.", category: "noun", declension: "3rd", gender: "f", number: "sg", custom: false },
            { id: 42, greek: "μεταμόρφωσις", romanized: "metamorphosis", meaning: "Transformation, change of form.", category: "noun", declension: "3rd", gender: "f", number: "sg", custom: false },
            { id: 43, greek: "φιλοσοφία", romanized: "philosophia", meaning: "Love of wisdom (philo + sophia). Philosophy.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 44, greek: "φιλανθρωπία", romanized: "philanthropia", meaning: "Love of humanity (philo + anthropos). Philanthropy.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 45, greek: "ἀπάθεια", romanized: "apatheia", meaning: "Freedom from passion, equanimity. Stoic ideal of emotional calm.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 46, greek: "ἀταραξία", romanized: "ataraxia", meaning: "Tranquility, freedom from disturbance. Epicurean ideal.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false },
            { id: 47, greek: "παράδεισος", romanized: "paradeisos", meaning: "Paradise, garden, enclosed park.", category: "noun", declension: "2nd", gender: "m", number: "sg", custom: false },
            { id: 48, greek: "εὕρηκα", romanized: "eureka", meaning: "I have found it! Exclamation of discovery.", category: "verb", declension: "", gender: "", number: "1st sg", custom: false },
            { id: 49, greek: "γνῶθι σεαυτόν", romanized: "gnothi seauton", meaning: "Know thyself. Famous inscription at the Temple of Apollo at Delphi.", category: "phrase", declension: "", gender: "", number: "", custom: false },
            { id: 50, greek: "καλοκἀγαθία", romanized: "kalokagathia", meaning: "The ideal of being beautiful and good; nobility of character combined with physical beauty.", category: "noun", declension: "1st", gender: "f", number: "sg", custom: false }
        ];

        // Version - increment this when dictionary structure changes
        const DICT_VERSION = 4;

        // State
        let words = [];
        let favorites = [];
        let currentTab = 'all';
        let searchQuery = '';

        // Initialize
        function init() {
            loadData();
            setupEventListeners();
            render();
        }

        // Load data from localStorage
        function loadData() {
            const savedVersion = localStorage.getItem('greek-dict-version');
            const savedWords = localStorage.getItem('greek-dict-words');
            const savedFavorites = localStorage.getItem('greek-dict-favorites');

            // If version changed, reload defaults but keep custom words
            if (savedVersion !== String(DICT_VERSION)) {
                let customWords = [];
                if (savedWords) {
                    const oldWords = JSON.parse(savedWords);
                    customWords = oldWords.filter(w => w.custom);
                }
                words = [...defaultWords, ...customWords];
                localStorage.setItem('greek-dict-version', DICT_VERSION);
                saveWords();
            } else if (savedWords) {
                words = JSON.parse(savedWords);
            } else {
                words = [...defaultWords];
                localStorage.setItem('greek-dict-version', DICT_VERSION);
                saveWords();
            }

            favorites = savedFavorites ? JSON.parse(savedFavorites) : [];
        }

        // Save data to localStorage
        function saveWords() {
            localStorage.setItem('greek-dict-words', JSON.stringify(words));
        }

        function saveFavorites() {
            localStorage.setItem('greek-dict-favorites', JSON.stringify(favorites));
        }

        // Event listeners
        function setupEventListeners() {
            // Search
            document.getElementById('search').addEventListener('input', (e) => {
                searchQuery = e.target.value.toLowerCase();
                render();
            });

            // Tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentTab = tab.dataset.tab;
                    render();
                });
            });

            // Add button
            document.getElementById('add-btn').addEventListener('click', () => {
                document.getElementById('modal').classList.add('active');
            });

            // Cancel button
            document.getElementById('cancel-btn').addEventListener('click', closeModal);

            // Save button
            document.getElementById('save-btn').addEventListener('click', saveNewWord);

            // Close modal on overlay click
            document.getElementById('modal').addEventListener('click', (e) => {
                if (e.target.id === 'modal') closeModal();
            });
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            document.getElementById('input-greek').value = '';
            document.getElementById('input-romanized').value = '';
            document.getElementById('input-meaning').value = '';
            document.getElementById('input-category').value = 'noun';
            document.getElementById('input-declension').value = '';
            document.getElementById('input-gender').value = '';
            document.getElementById('input-number').value = '';
        }

        function saveNewWord() {
            const greek = document.getElementById('input-greek').value.trim();
            const romanized = document.getElementById('input-romanized').value.trim();
            const meaning = document.getElementById('input-meaning').value.trim();
            const category = document.getElementById('input-category').value;
            const declension = document.getElementById('input-declension').value;
            const gender = document.getElementById('input-gender').value;
            const number = document.getElementById('input-number').value;

            if (!greek || !meaning) {
                alert('Please enter at least the Greek word and its meaning.');
                return;
            }

            const newWord = {
                id: Date.now(),
                greek,
                romanized: romanized || '',
                meaning,
                category,
                declension: declension || '',
                gender: gender || '',
                number: number || '',
                custom: true
            };

            words.push(newWord);
            saveWords();
            closeModal();
            render();
        }

        function toggleFavorite(id) {
            const index = favorites.indexOf(id);
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(id);
            }
            saveFavorites();
            render();
        }

        function deleteWord(id) {
            if (confirm('Delete this word?')) {
                words = words.filter(w => w.id !== id);
                favorites = favorites.filter(f => f !== id);
                saveWords();
                saveFavorites();
                render();
            }
        }

        function getFilteredWords() {
            let filtered = words;

            // Filter by tab
            if (currentTab === 'favorites') {
                filtered = filtered.filter(w => favorites.includes(w.id));
            } else if (currentTab === 'custom') {
                filtered = filtered.filter(w => w.custom);
            }

            // Filter by search
            if (searchQuery) {
                filtered = filtered.filter(w =>
                    w.greek.toLowerCase().includes(searchQuery) ||
                    w.meaning.toLowerCase().includes(searchQuery) ||
                    (w.romanized && w.romanized.toLowerCase().includes(searchQuery))
                );
            }

            return filtered;
        }

        function render() {
            const filtered = getFilteredWords();
            const container = document.getElementById('word-list');

            // Update stats
            document.getElementById('total-count').textContent = words.length;
            document.getElementById('favorites-count').textContent = favorites.length;
            document.getElementById('custom-count').textContent = words.filter(w => w.custom).length;

            if (filtered.length === 0) {
                const emptyMessages = {
                    all: 'No words found',
                    favorites: 'No favorites yet. Tap the heart to add!',
                    custom: 'No custom words yet. Tap + to add!'
                };
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">${currentTab === 'favorites' ? '&#9825;' : '&#128218;'}</div>
                        <p>${emptyMessages[currentTab]}</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filtered.map(word => `
                <div class="word-card">
                    <div class="word-header">
                        <div>
                            <div class="greek-word">${escapeHtml(word.greek)}</div>
                            ${word.romanized ? `<div class="romanized">${escapeHtml(word.romanized)}</div>` : ''}
                        </div>
                        <div class="word-actions">
                            <button class="favorite-btn ${favorites.includes(word.id) ? 'active' : ''}" onclick="toggleFavorite(${word.id})">
                                ${favorites.includes(word.id) ? '&#9829;' : '&#9825;'}
                            </button>
                            ${word.custom ? `<button class="delete-btn" onclick="deleteWord(${word.id})">&#128465;</button>` : ''}
                        </div>
                    </div>
                    <div class="meaning">${escapeHtml(word.meaning)}</div>
                    <span class="category">${escapeHtml(word.category)}</span>
                    ${(word.declension || word.gender || word.number) ? `
                    <div class="grammar">
                        ${word.declension ? `<span class="grammar-tag">${escapeHtml(word.declension)} decl.</span>` : ''}
                        ${word.gender ? `<span class="grammar-tag gender-${word.gender.charAt(0)}">${formatGender(word.gender)}</span>` : ''}
                        ${word.number ? `<span class="grammar-tag">${formatNumber(word.number)}</span>` : ''}
                    </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function formatGender(g) {
            const genders = {
                'm': 'masc.',
                'f': 'fem.',
                'n': 'neut.',
                'm/f': 'masc./fem.',
                'm/f/n': 'all genders'
            };
            return genders[g] || g;
        }

        function formatNumber(n) {
            const numbers = {
                'sg': 'singular',
                'pl': 'plural',
                '1st sg': '1st pers. sg.'
            };
            return numbers[n] || n;
        }

        // Start the app
        init();
    </script>
</body>
</html>
